---
layout: default
title: "Practical Security Assessment (Penetration Testing) - Passive Intelligence Gathering"
permalink: "/pentest/03-Passive-Intelligence-Gathering/"
---

<div class="lead">
<ul>
    <li>OSINT<ul>
            <li><a href="https://medium.com/@micallst/osint-resources-for-2019-b15d55187c3f">OSINT
                    resources 2019</a></li>
            <li><a href="https://github.com/jivoi/awesome-osint">Awesome OSINT</a></li>
            <li>Public data from courthouses, tax forms, and so on</li>
            <li>Search engines</li>
            <li>Conferences</li>
            <li>Academic sources</li>
            <li>Blogs</li>
            <li>Research reports</li>
            <li>Metadata from pictures, executables, documents, and so on</li>
        </ul>
    </li>
    <li>Footprinting<ul>
            <li>Name servers</li>
            <li>IP ranges</li>
            <li>Banners</li>
            <li>Operating Systems</li>
            <li>Determining if IDS/IPS is used</li>
        </ul>
    </li>
</ul>
<p>Some of the how-to on recon by <a href="https://null-byte.wonderhowto.com/how-to/recon/">Null-Byte</a></p>
<h2 id="recon-ng">Recon-ng</h2>
<p>Recong-ng gives information about IP space, locations, users, emails, and more. You can connect
    different API keys with recon-ng (such as <a href="http://ipinfodb.com/register.php">IP info DB</a>).
    It will also search information about the company in google, bing, and baidu. It can brute-force
    subdomains, resolve domain names to IP (and vice versa), and even make a nice looking HTML report of
    all gathered data.</p>
<p>Example (by default, no modulees are installed, so we gotta install them first):</p>
<pre><code class="language-sh">marketplace install hackertarget
modules load hackertarget
show options
options set SOURCE domain.com
info
input
run</code></pre>
<p>To see all modules:</p>
<pre><code class="language-sh">show modules</code></pre>
<p>To get the info (e.g., hosts) after you ran the modules:</p>
<pre><code class="language-sh">show hosts</code></pre>
<h2 id="discover-scripts">Discover Scripts</h2>
<p><a href="https://github.com/leebaird/discover">Discover Scripts</a> is a set of tools for passive OSINT.
    The tools include dnsrecon, goofile, goog-mail, goohost, theharvester, metasploit, urlcrazy, whois,
    dnssy, ewhois, myipneighbor, and urlvoid.</p>
<h2 id="subdomain-enumeration">Subdomain Enumeration</h2>
<ul>
    <li><a href="https://github.com/jonluca/Anubis">Anubis</a> subdomain enumeration and information
        gathering tool</li>
    <li><a href="https://github.com/guelfoweb/knock">KNOCK</a> can enumerate subdomains based on a wordlist
        like <a href="https://gist.githubusercontent.com/cheetz/4d6a26bb122a942592ab9ac21894e57b/raw/f58e82c9abfa46a932eb92edbe6b18214141439b/all.txt">this
            one</a>.</li>
    <li><a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a> uses google-dorking to find
        subdomains.</li>
    <li><a href="https://github.com/TheRook/subbrute">SubBrute</a> enumerates subdomains based on DNS
        metadata.</li>
</ul>
<h2 id="searching-github-history">Searching GitHub history</h2>
<ul>
    <li><a href="https://github.com/dxa4481/truffleHog">Truffle Hog</a> is an excellent tool to search
        through commit history and idetify some juicy info for read teamers.</li>
    <li><a href="https://github.com/michenriksen/gitrob">Gitrob</a> searches for the juicy stuff on scale
        for a particular organization, it will try to find all developers who are somehow connected with
        the company and search for APIs, passwords, SSH keys, etc.</li>
</ul>
<h2 id="dns-recon">DNS Recon</h2>
<blockquote>
    <p>CNAME - alias, used to tie many names to a single IP. An IP address can have multiple CNAME records
        associated with it.
        A - used to translate a domain or subdomain name to a 32-bit IP address. It can also store
        additional useful information.
        MX - ties a domain name to associated mail servers.</p>
</blockquote>
<p>A website to perform all kinds of lookups online: <a href="https://viewdns.info/">ViewDNS</a></p>
<h3 id="nslookup">nslookup</h3>
<pre><code class="language-sh">
$ nslookup domain.com
$ nslookup domain.com 8.8.8.8
$ nslookup -type=ns domain.com 8.8.8.8
</code></pre>
<p>Save the output to the file:</p>
<pre><code class="language-sh">
$ nslookup -type=ns domain.com 8.8.8.8 &gt; nslookup.txt
$ nslookup domain.com &gt;&gt; nslookup.txt
</code></pre>
<h3 id="domain-information-groper-dig-">Domain Information Groper (DIG)</h3>
<p><a href="http://www.digwebinterface.com/">Online public version of DIG</a></p>
<pre><code class="language-sh">
$ dig domain.com
$ dig domain.com any
</code></pre>
<p>The fun part: zone transfers and Bind version</p>
<pre><code class="language-sh">
$ dig axfr @ns1.domain.com domain.com
$ dig +nocmd +noall +answer VERSION.BIND @ns1.domain.com domain.com
</code></pre>
<p>Reverse DNS lookup</p>
<pre><code class="language-sh">$ dig +nocmd +noall +answer -x 192.168.0.1</code></pre>
<p>DNS Brute-Forcing</p>
<pre><code class="language-sh">
$ fierce --domain example.com
$ fierce --domain example.com --subdomain-file ourOwnWordList.txt
$ fierce --domain example.com --wide
$ perl blindcrawl.pl -d domain.com
$ python gxfr.py --bxfr --dns-lookup -o domain.com
</code></pre>
<p>Crawling through IP space to get DNS names:</p>
<pre><code class="language-sh">$ ipcrawl 148.87.1.1 148.87.1.254 #oracle</code></pre>
<h3 id="whois">whois</h3>
<p>Top registrars</p>
<ul>
    <li>AFRINIC - <a href="http://www.afrinic.net">http://www.afrinic.net</a></li>
    <li>APNIC - <a href="http://www.apnic.net">http://www.apnic.net</a></li>
    <li>ARIN - <a href="http://ws.arin.net">http://ws.arin.net</a></li>
    <li>IANA - <a href="http://www.iana.com">http://www.iana.com</a></li>
    <li>ICANN - <a href="http://www.icann.org">http://www.icann.org</a></li>
    <li>LACNIC - <a href="http://www.lacnic.net">http://www.lacnic.net</a></li>
    <li>NRO - <a href="http://www.nro.net">http://www.nro.net</a></li>
    <li>RIPE - <a href="http://www.ripe.net">http://www.ripe.net</a></li>
    <li>InterNic - <a href="http://www.internic.net">http://www.internic.net</a></li>
</ul>
<pre><code class="language-sh">$ whois domain.com
Using a specific registrar
$ whois -h whois.apnic.net domain.com</code></pre>
<h2 id="shodan">Shodan</h2>
<p><a href="https://www.shodan.io">Shodan</a>
    Filters:</p>
<ul>
    <li>net: Possibly one of the most useful filters for a penetration tester. You can search your IP
        ranges using IP/CIDR notation (for example, 127.1.1.0/24) to see if all of your devices are
        configured as expected or if there are indicators that a vulnerable server or network device
        configuration is externally facing and ready to be compromised during testing.</li>
    <li>city: This will limit the search to the city listed.</li>
    <li>country: Restricts the search to devices in the country of choice. This is also very important for
        pentesting, as there may be times when a client provides you with IP ranges (which you validated,
        right?), and then places certain assets out of scope due to location. A client may choose to not
        test against systems located in Singapore for instance.</li>
    <li>port: Will restrict the search to the port indicated. Remember that Shodan does not scan index
        banners for all ports, only for 80, 21, 22, and 23.</li>
    <li>before: Search for systems scanned before a specified date.</li>
    <li>after: Search for systems scanned after this date.</li>
    <li>os: Specify operating systems you want to include or exclude in your search.</li>
</ul>
<p>Example:</p>
<ul>
    <li><a href="https://hackernoon.com/leaklooker-find-open-databases-in-a-second-9da4249c8472">Find open
            databases</a></li>
</ul>
<h2 id="census-arin-and-pastebin-dumps">Census, ARIN, and pastebin dumps</h2>
<ul>
    <li><a href="https://censys.io">Census</a> is a web service to identify reachable servers and devices
        given IP ranges. It is quite useful to check out what is visible from the outside of the
        organization.</li>
    <li><a href="https://www.arin.net/">ARIN</a> allows you to lookup IP ranges for a particular
        organization in the US.</li>
    <li><a href="https://psbdmp.ws/">Pastebin Dumps</a> allows you to find out if any of the users&apos;
        data have been previously dumped on the pastebin websites.</li>
</ul>
<h2 id="http-banner">HTTP banner</h2>
<pre><code class="language-sh">$ nc domain.com 80</code></pre>
<h2 id="google-hacking">Google Hacking</h2>
<ul>
    <li><a href="https://www.exploit-db.com/google-hacking-database/">Google Hacking Database</a> and <a href="https://medium.com/@shaistha24/google-hacking-2093c68e351f">Google Hacking for Pentesters explained</a></li>
    <li><a href="http://com.lullar.com/">Search People by Name or Email</a></li>
    <li><a href="http://www.peekyou.com/">Search People by Name</a></li>
    <li><a href="http://www.tineye.com/">Reverse Image Search</a></li>
    <li><a href="http://archive.org/web/web.php">Archived Copies of Websites</a></li>
</ul>
<h2 id="load-balancing-and-ips-detection">Load-Balancing and IPS Detection</h2>
<p>Try to do DIG on google.com and notice how many IP addresses are returned. More than one, right? This is
    because there is a load balancer that balances input traffic.</p>
<ul>
    <li><a href="https://github.com/craig/ge.mine.nu/tree/master/lbd">Load Balancing Detector (DNS and
            HTTP)</a></li>
    <li>Fingerprint Web Application Firewall (WAF) products protecting a website: <a href="https://github.com/EnableSecurity/wafw00f">WAFwoof</a></li>
    <li>Layer Four Traceroute: <a href="http://pwhois.org/lft/">http://pwhois.org/lft/</a></li>
    <li>Firewall Tester: <a href="http://www.isecom.org/mirror/ftester-0.9.tar.gz">http://www.isecom.org/mirror/ftester-0.9.tar.gz</a></li>
    <li>NSE script for WAF detection: <code>$ nmap --script http-waf-detect.nse ...</code></li>
</ul>
<h2 id="proxies">Proxies</h2>
<p>Gather Proxy: <a href="http://gatherproxy.com">http://gatherproxy.com</a>
    Find elite proxies (based on gatherproxy.com): <a href="https://github.com/DanMcInerney/elite-proxy-finder">https://github.com/DanMcInerney/elite-proxy-finder</a></p>
<h2 id="email-subdomain-names-banners-harvesting">Email/Subdomain/Names/Banners Harvesting</h2>
<p><a href="https://github.com/laramies/theHarvester">TheHarvester</a>: <code>$ theharvester -d domain.com
        -l 50 -b google {linkedin | pgp | all}</code></p>
<h2 id="Tor">Tor and Privacy</h2>
<p><a href="https://medium.com/@jamesmacwhite/running-the-tor-browser-on-kali-linux-the-proper-way-d33a38b54e96">Running
    Tor browser on Kali the proper way</a></p>
<p><a href="https://www.makeuseof.com/tag/find-active-onion-sites/">How to find active onion sites to access using Tor</a></p>
<p>To use Kali commands through Tor, you have to run them through proxychains tool: <code>$ proxychains nmap -sT -p80 IP_ADDR</code></p>
<p><a href="https://www.privacytools.io/">Privacy Tools</a></p>
</div>
