<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Vitaly Ford smart grid security research">
    <meta name="author" content="Vitaly Ford">
    <link rel="icon" href="../../favicon.ico">

    <title>Vitaly Ford's Personal Website</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/navbar-fixed-top.css" rel="stylesheet">

    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="jumbotron">
<pre>
/*
As you can see here, there are three weird functions.
Try to guess what are the correct values of input that
you should put into those functions. If you guess correctly,
concatenate the output from those functions and you will see
a string in a format such as cs242{...} where instead of the
three dots you will have an md5 hash that is 32 characters long.

Your goal would be to crack that md5 hash that you find
in between curly braces after cs242. The hash will spell out
the name of a famous song. In order to crack it, you can use
online tools (let google help you).
*/

private String alphabet = "abcdefghijklmnopqrstuvwxyz.,-!?/; @$";
private String alpha    = "7csc{249sfbf46p{f2dua{core23234fdlfs";
private String beta     = "89fbde440mn021p3ob62d3d741fs9nb52ejh";
private String gamma    = "45}bd}e9rt}e0jdamc}4lp3}89sj}4g38ch4";

public String first(String lowerCaseNameOfPublicKeyExchangeContainingDH) {
    String firstPart = "";
    Boolean firstI = false, firstF = false, firstE = false;
    for (int i = 0; i < lowerCaseNameOfPublicKeyExchangeContainingDH.length(); i++) {
        int index = alphabet.indexOf(lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i));

        if (firstI && lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'i')
            firstPart += "2";
        else if (firstF && lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'f')
            firstPart += "4";
        else if (firstE && lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'e')
            firstPart += "2";
        else
            firstPart += alpha.charAt(index);

        if (lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'i')
            firstI = true;
        else if (lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'f')
            firstF = true;
        else if (lowerCaseNameOfPublicKeyExchangeContainingDH.charAt(i) == 'e')
            firstE = true;
    }
    return firstPart;
}

public String second(String lowerCaseFullNameOfRSA) {
    String secondPart = "";
    Integer firstI = 0, firstR = 0, firstE = 0, firstS = 0, firstA = 0, firstM = 0, firstD = 0;
    for (int i = 0; i < lowerCaseFullNameOfRSA.length(); i++) {
        int index = alphabet.indexOf(lowerCaseFullNameOfRSA.charAt(i));

        if (firstI == 1 && lowerCaseFullNameOfRSA.charAt(i) == 'i')
            secondPart += "7";
        else if (firstR == 1 && lowerCaseFullNameOfRSA.charAt(i) == 'r')
            secondPart += "8";
        else if (firstE == 1 && lowerCaseFullNameOfRSA.charAt(i) == 'e')
            secondPart += "1";
        else if (firstS == 1 && lowerCaseFullNameOfRSA.charAt(i) == 's')
            secondPart += "6";
        else if (firstA == 1 && lowerCaseFullNameOfRSA.charAt(i) == 'a')
            secondPart += "f";
        else if (firstA == 2 && lowerCaseFullNameOfRSA.charAt(i) == 'a')
            secondPart += "5";
        else if (firstM == 1 && lowerCaseFullNameOfRSA.charAt(i) == 'm')
            secondPart += "c";
        else if (firstD == 1 && lowerCaseFullNameOfRSA.charAt(i) == '-')
            secondPart += "0";
        else
            secondPart += beta.charAt(index);

        if (lowerCaseFullNameOfRSA.charAt(i) == 'i')
            firstI += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == 'r')
            firstR += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == 'e')
            firstE += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == 's')
            firstS += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == 'a')
            firstA += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == 'm')
            firstM += 1;
        else if (lowerCaseFullNameOfRSA.charAt(i) == '-')
            firstD += 1;
    }
    return secondPart;
}

public String third(String lowerCaseCryptographicHashFunctionWithASecretCryptographicKey) {
    String thirdPart = "";
    for (int i = 0; i < lowerCaseCryptographicHashFunctionWithASecretCryptographicKey.length(); i++) {
        int index = alphabet.indexOf(lowerCaseCryptographicHashFunctionWithASecretCryptographicKey.charAt(i));
        thirdPart += gamma.charAt(index);
    }
    return thirdPart;
}
</pre>
      </div>
    </div>
  </body>
</html>
